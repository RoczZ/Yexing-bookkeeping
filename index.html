<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤œè¡Œè®°è´¦</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon.png" type="image/png">
</head>
<body>
    <div class="phone-container">
        <div class="phone-screen">
            <div class="scrollable-content">
                <!-- Logo -->
                <div class="logo-container">
                    <img src="icon.png" alt="å¤œè¡Œè®°è´¦" class="logo">
                    <span class="logo-text">å¤œè¡Œè®°è´¦</span>
                </div>
                
                <!-- æ¨¡å—1ï¼šæ—¥æœŸå’Œæ”¶æ”¯ç»Ÿè®¡ -->
                <div class="header-section">
                    <div class="date" id="currentDate">2026å¹´1æœˆ24æ—¥ <span class="days-left" id="daysLeft">æœ¬æœˆå‰©ä½™XXXXå¤©</span></div>
                    <div class="today-stats">
                        <div class="stat-item">
                            <span class="label">ç´¯è®¡æ”¯å‡º</span>
                            <span class="value">XXXXå…ƒ</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">ç´¯è®¡æ”¶å…¥</span>
                            <span class="value">XXXXå…ƒ</span>
                        </div>
                        <div class="stat-item total">
                            <span class="label">åˆè®¡</span>
                            <span class="value">XXXXå…ƒ</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">2026å…¨å¹´å­˜æ¬¾é‡‘é¢</span>
                            <span class="value">XXXXå…ƒ</span>
                        </div>
                    </div>
                </div>
                
                <script>
                    // è®¡ç®—æœ¬æœˆå‰©ä½™å¤©æ•°
                    function updateDateInfo() {
                        const now = new Date();
                        const currentYear = now.getFullYear();
                        const currentMonth = now.getMonth() + 1; // æœˆä»½ä»0å¼€å§‹ï¼Œéœ€è¦+1
                        const currentDay = now.getDate();
                        
                        // è·å–æœ¬æœˆæœ€åä¸€å¤©
                        const lastDayOfMonth = new Date(currentYear, currentMonth, 0).getDate();
                        
                        // è®¡ç®—å‰©ä½™å¤©æ•°
                        const daysLeft = lastDayOfMonth - currentDay;
                        
                        // æ ¼å¼åŒ–æ—¥æœŸæ˜¾ç¤º
                        const formattedDate = `${currentYear}å¹´${currentMonth.toString().padStart(2, '0')}æœˆ${currentDay.toString().padStart(2, '0')}æ—¥`;
                        
                        // æ›´æ–°é¡µé¢æ˜¾ç¤º
                        document.getElementById('currentDate').innerHTML = `${formattedDate} <span class="days-left" id="daysLeft">æœ¬æœˆå‰©ä½™${daysLeft}å¤©</span>`;
                    }
                    
                    // è®¡ç®—å½“æœˆæ”¯å‡ºæ€»å’Œ
                    function calculateMonthlyExpense() {
                        const now = new Date();
                        const currentYear = now.getFullYear();
                        const currentMonth = now.getMonth() + 1; // æœˆä»½ä»0å¼€å§‹ï¼Œéœ€è¦+1
                        
                        // ä»localStorageè·å–æ‰€æœ‰è®°å½•
                        const records = JSON.parse(localStorage.getItem('financeRecords') || '[]');
                        
                        // ç­›é€‰å½“æœˆçš„æ”¯å‡ºè®°å½•
                        const monthlyExpenses = records.filter(record => {
                            // æ£€æŸ¥æ˜¯å¦æ˜¯æ”¯å‡º
                            if (record.category !== 'expense') return false;
                            
                            // æ£€æŸ¥æ˜¯å¦æ˜¯å½“æœˆ
                            const recordDate = record.date;
                            const recordYear = parseInt(recordDate.split('å¹´')[0]);
                            const recordMonth = parseInt(recordDate.split('å¹´')[1].split('æœˆ')[0]);
                            
                            return recordYear === currentYear && recordMonth === currentMonth;
                        });
                        
                        // è®¡ç®—æ”¯å‡ºæ€»å’Œ
                        const totalExpense = monthlyExpenses.reduce((sum, record) => sum + record.amount, 0);
                        
                        return totalExpense;
                    }
                    
                    // è®¡ç®—å½“æœˆæ”¶å…¥æ€»å’Œ
                    function calculateMonthlyIncome() {
                        const now = new Date();
                        const currentYear = now.getFullYear();
                        const currentMonth = now.getMonth() + 1; // æœˆä»½ä»0å¼€å§‹ï¼Œéœ€è¦+1
                        
                        // ä»localStorageè·å–æ‰€æœ‰è®°å½•
                        const records = JSON.parse(localStorage.getItem('financeRecords') || '[]');
                        
                        // ç­›é€‰å½“æœˆçš„æ”¶å…¥è®°å½•
                        const monthlyIncomes = records.filter(record => {
                            // æ£€æŸ¥æ˜¯å¦æ˜¯æ”¶å…¥
                            if (record.category !== 'income') return false;
                            
                            // æ£€æŸ¥æ˜¯å¦æ˜¯å½“æœˆ
                            const recordDate = record.date;
                            const recordYear = parseInt(recordDate.split('å¹´')[0]);
                            const recordMonth = parseInt(recordDate.split('å¹´')[1].split('æœˆ')[0]);
                            
                            return recordYear === currentYear && recordMonth === currentMonth;
                        });
                        
                        // è®¡ç®—æ”¶å…¥æ€»å’Œ
                        const totalIncome = monthlyIncomes.reduce((sum, record) => sum + record.amount, 0);
                        
                        return totalIncome;
                    }
                    
                    // è®¡ç®—2026å…¨å¹´å­˜æ¬¾é‡‘é¢
                    function calculateYearlySavings() {
                        const targetYear = 2026;
                        
                        // ä»localStorageè·å–æ‰€æœ‰è®°å½•
                        const records = JSON.parse(localStorage.getItem('financeRecords') || '[]');
                        
                        // ç­›é€‰2026å¹´çš„æ”¶å…¥è®°å½•
                        const yearlyIncomes = records.filter(record => {
                            if (record.category !== 'income') return false;
                            const recordYear = parseInt(record.date.split('å¹´')[0]);
                            return recordYear === targetYear;
                        });
                        
                        // ç­›é€‰2026å¹´çš„æ”¯å‡ºè®°å½•
                        const yearlyExpenses = records.filter(record => {
                            if (record.category !== 'expense') return false;
                            const recordYear = parseInt(record.date.split('å¹´')[0]);
                            return recordYear === targetYear;
                        });
                        
                        // è®¡ç®—2026å¹´æ”¶å…¥æ€»å’Œ
                        const totalIncome = yearlyIncomes.reduce((sum, record) => sum + record.amount, 0);
                        
                        // è®¡ç®—2026å¹´æ”¯å‡ºæ€»å’Œ
                        const totalExpense = yearlyExpenses.reduce((sum, record) => sum + record.amount, 0);
                        
                        // è®¡ç®—å…¨å¹´å­˜æ¬¾é‡‘é¢ï¼ˆæ”¶å…¥-æ”¯å‡ºï¼‰
                        const yearlySavings = totalIncome - totalExpense;
                        
                        return yearlySavings;
                    }
                    
                    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                    function updateStats() {
                        // æ›´æ–°æ—¥æœŸä¿¡æ¯
                        updateDateInfo();
                        
                        // è®¡ç®—å½“æœˆæ”¯å‡º
                        const monthlyExpense = calculateMonthlyExpense();
                        
                        // è®¡ç®—å½“æœˆæ”¶å…¥
                        const monthlyIncome = calculateMonthlyIncome();
                        
                        // è®¡ç®—åˆè®¡
                        const total = monthlyIncome - monthlyExpense;
                        
                        // è®¡ç®—2026å…¨å¹´å­˜æ¬¾é‡‘é¢
                        const yearlySavings = calculateYearlySavings();
                        
                        // æ›´æ–°é¡µé¢æ˜¾ç¤º
                        const expenseElement = document.querySelector('.today-stats .stat-item:nth-child(1) .value');
                        if (expenseElement) {
                            expenseElement.textContent = `${monthlyExpense}å…ƒ`;
                        }
                        
                        const incomeElement = document.querySelector('.today-stats .stat-item:nth-child(2) .value');
                        if (incomeElement) {
                            incomeElement.textContent = `${monthlyIncome}å…ƒ`;
                        }
                        
                        const totalElement = document.querySelector('.today-stats .stat-item.total .value');
                        if (totalElement) {
                            totalElement.textContent = `${total}å…ƒ`;
                        }
                        
                        const yearlySavingsElement = document.querySelector('.today-stats .stat-item:nth-child(4) .value');
                        if (yearlySavingsElement) {
                            yearlySavingsElement.textContent = `${yearlySavings}å…ƒ`;
                        }
                    }
                    
                    // é¡µé¢åŠ è½½æ—¶è®¡ç®—å¹¶æ˜¾ç¤º
                    window.onload = updateStats;
                </script>
                
                <!-- æ¨¡å—2ï¼šæ”¯å‡ºå’Œæ”¶å…¥æŒ‰é’® -->
                <div class="action-buttons">
                    <a href="expense.html" class="expense-btn">æ”¯å‡º</a>
                    <a href="income.html" class="income-btn">æ”¶å…¥</a>
                </div>
                
                <!-- æŸ¥çœ‹èµ„é‡‘æµæ°´ -->
                <div style="margin-top: 15px;">
                    <a href="records.html" style="display: block; text-align: center; padding: 12px; background-color: #f5f5f5; color: #000; text-decoration: none; border-radius: 10px; font-size: 14px;">æŸ¥çœ‹èµ„é‡‘æµæ°´</a>
                </div>
            </div>
            
            <!-- åº•éƒ¨å¯¼èˆªæ  -->
            <nav class="bottom-nav">
                <a href="index.html" class="bottom-nav-item active">
                    <span class="bottom-nav-icon">ğŸ </span>
                    <span>é¦–é¡µ</span>
                </a>
                <a href="records.html" class="bottom-nav-item">
                    <span class="bottom-nav-icon">ğŸ“Š</span>
                    <span>è´¦å•</span>
                </a>
                <a href="me.html" class="bottom-nav-item">
                    <span class="bottom-nav-icon">ğŸ‘¤</span>
                    <span>æˆ‘çš„</span>
                </a>
            </nav>
        </div>
    </div>
</body>
</html>